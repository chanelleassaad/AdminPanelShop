<div class="mat-elevation-z8">
  @if (label == "Customers") {
    <div class="flex justify-end p-1">
      <button
        (click)="addCustomer()"
        class="p-2 flex items-center justify-center bg-medium-purple text-white border border-medium-purple rounded-lg cursor-pointer transition-colors duration-300 ease-in-out active:bg-white active:text-medium-purple active:border-medium-purple"
      >
        <p>Add Customer</p>
        <mat-icon>add</mat-icon>
      </button>
    </div>
  }

  <div class="overflow-x-auto">
    <table mat-table [dataSource]="dataSource" matSort class="w-full">
      @for (column of displayedColumns; track column) {
        <ng-container [matColumnDef]="column">
          <th mat-header-cell *matHeaderCellDef class="w-2.5">
            {{ column | titlecase }}
          </th>
          <td mat-cell *matCellDef="let element" class="w-2.5">
            <!-- Products Column -->
            @if (column == "products") {
              {{ element.products ? element.products.length : 0 }}
            } @else {
              @if (column == "orders") {
                @for (order of element.orders; track order) {
                  <div>
                    {{ order.orderId }}
                  </div>
                }
              } @else {
                @if (column == "addresses") {
                  @for (address of element.addresses; track address) {
                    <div>
                      {{ address.street + ", " + address.city }}
                    </div>
                  }
                } @else {
                  @if (column == "status") {
                    <select
                      matNativeControl
                      required
                      [(ngModel)]="element.status"
                      class="p-1"
                    >
                      <option value="Pending">Pending</option>
                      <option value="Processing">Processing</option>
                      <option value="Shipped">Shipped</option>
                      <option value="Delivered">Delivered</option>
                    </select>
                  } @else {
                    {{ element[column] }}
                  }
                }
              }
            }
          </td>
        </ng-container>
      }

      <!-- Action Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef class="w-2.5"></th>
        <td mat-cell *matCellDef="let element" class="w-2.5">
          <!-- Edit Button -->
          <button mat-icon-button (click)="onEdit(element)">
            <mat-icon>edit</mat-icon>
          </button>
          <!-- Delete Button -->
          @if (label == "Customers") {
            <button mat-icon-button (click)="onDelete(element)">
              <mat-icon>delete</mat-icon>
            </button>
          }
        </td>
      </ng-container>

      <!-- Header and row definitions -->
      <tr
        mat-header-row
        class="!w-2.5 !bg-medium-purple !text-white !border !border-white"
        *matHeaderRowDef="
          label == 'Orders' ? displayedColumns : displayedColumnsWithActions
        "
      ></tr>
      <tr
        mat-row
        *matRowDef="
          let row;
          columns: label == 'Orders'
            ? displayedColumns
            : displayedColumnsWithActions
        "
        class="w-2.5"
      ></tr>
    </table>
  </div>
</div>

<!-- Paginator -->
<div class="mb-2.5 border border-[#2d0a75]">
  <mat-paginator
    [length]="dataSource.data.length"
    [pageSize]="5"
    [pageSizeOptions]="[5, 10, 25]"
    aria-label="Select page"
  ></mat-paginator>
</div>
